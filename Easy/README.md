This part is the easy part algorithm.
